<div id="view-challenge-container" ng-controller="challengeCtrl" ng-init="viewInit()">
	
	<div class="jumbotron" ng-style="{'background-image': 'url(' + challenge.header_images[0] + ')' }">
		<div class="container">
			<h1>{{challenge.title}}</h1>
			<p>{{challenge.subtitle}}</p>
			<ul id="myTab" class="nav nav-tabs">
				<li class="active">
					<a href="#home" data-toggle="tab">Inicio</a>
				</li>
			   	<li ng-repeat="p in challenge.pages">
					<a href="#{{p.content_type}}-page" data-toggle="tab">{{p.title}}</a>
				</li>
				<li>
					<a href="#stages" data-toggle="tab">Etapas</a>
				</li>
				<li>
					<a href="#submissions" data-toggle="tab">Propuestas ({{projects.length}})</a>
				</li>
			</ul>
		</div>
	</div>

	<div class="container">
	  <div class="row">
	    <div class="col-md-8">

				<div class="tab-content">
				  
					<div class="tab-pane active" id="home">
						<p ng-bind-html="challenge.description"></p>
					</div>

					<div class="tab-pane" id="stages">
						<h2>Etapas</h2>
						<ul>
							<li ng-repeat="s in challenge.stages">
								<strong>{{s.name}}</strong> | Desde: {{s.start | date:'dd-MM-yyyy HH:mm'}} | Hasta: {{s.end | date:'dd-MM-yyyy HH:mm'}}
							</li>
						</ul>
					</div>

					<div class="tab-pane" id="{{p.content_type}}-page" ng-repeat="p in challenge.pages">
						<p ng-bind-html="p.text"></p>
					</div>
				
					<div class="tab-pane" id="submissions">
						<h2>Participaciones: ({{projects.length}})</h2>
							<div class="row">
								<p ng-show="challenge.categories.length > 0">
									Filtro: 
									<select ng-model="filter.cat" ng-options="option for option in challenge.categories">
										<option value="">Todas</option>
									</select>
								</p>
								{{filter.cat}}
							</div>
							<div class="row">
								<div class="col-sm-6 col-md-6" ng-repeat="project in projects | filter: {tags:filter.cat}" ng-include="'ng-client/modules/project/card.html'">
								</div>
							</div>
					</div>

				</div>

	    </div>
	    <div class="col-md-4">

			<a 	ng-click="openParticipatePopup()" 
					href="javascript:;" 
					ng-style="{ 'background-color': challenge.call_to_action.bgcolor ,
								'color': challenge.call_to_action.color
								}" 
					class="btn btn-lg btn-block">

					{{challenge.call_to_action.label}}
				</a>
				<p class="text-center">{{challenge.call_to_action.help}}</p>

			<div>
                <p ng-show="challenge.open"><h2><span class="label label-success">ABIERTO</span></h2></p>
                <p ng-show="!challenge.open"><span class="label label-danger">CERRADO</span></p>

				<h3>Etapa actual:</h3>
				{{currentStages.stages}}


			</div>

	      	<h2>data</h2>
			<p>Slug: {{challenge.slug}}</p>
			<p>Create: {{challenge.created_at}}</p>
			<p>Abierto: {{challenge.open}}</p>
			<p>contact: {{challenge.contact}}</p>
			<p>link color: {{challenge.link_color}}</p>

			<div ng-show="userCanEdit">
				<h2>actions</h2>
				<a href="/#/challenge/{{challenge._id}}/edit">Editar</a>
	    	</div>
	    </div>
	  </div>
	</div>

	<div class="modal fade bs-example-modal-lg" id="participate" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
	  <div class="modal-dialog modal-lg">
	    <div class="modal-content">
	      <div class="modal-header" ng-style="{'background-image': 'url(' + challenge.header_images[0] + ')', 'background-size':'cover', 'background-position': 'center center' }">
	        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
	        <h4 class="modal-title" id="myModalLabel">Participá ahora en: <strong>{{challenge.title}}</strong></h4>
	      </div>

	      <div class="modal-body">

			<form role="form">
			  <div class="form-group">
			    <label>Categoría:</label>
				<select class="form-control" ng-show="challenge.categories.length > 0" ng-model="project.tags" ng-options="option for option in challenge.categories">
					<option value="">-- seleccionar --</option>
				</select>
				<small>Seleccione una categoría</small>
			  </div>
			<div class="form-group" ng-repeat="s in challenge.submit_fields | orderBy:'order'">
			    <label>{{s.label}}</label>
			    <input class="form-control" type="text" ng-model="project[s.type]" />
				<small>{{s.help}}</small>
			</div>
			</form>


			<p class="text-center">{{challenge.call_to_action.help}}</p>
	      </div>
	      <div class="modal-footer">
  			<a 	ng-click="addProject(project)"
			href="javascript:;" 
			ng-style="{ 'background-color': challenge.call_to_action.bgcolor ,
						'color': challenge.call_to_action.color
						}" 
			class="btn btn-lg btn-block">
				{{challenge.call_to_action.label}}
			</a>
	      </div>
	    </div>
	  </div>
	</div>



	
